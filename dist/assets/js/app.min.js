"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _createForOfIteratorHelper(e,t){var r,n,o,a,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return n=!(r=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){n=!0,o=e},f:function(){try{r||null==i.return||i.return()}finally{if(n)throw o}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var globalActiveHabbitId,habbits=[],HABBIT_KEY="HABBIT_KEY",page={menu:document.querySelector(".menu__list"),header:{title:document.querySelector(".header__title"),progressPersent:document.querySelector(".progress__percent"),progressCoverBar:document.querySelector(".progress__cover-bar")},body:{day:document.querySelector(".habbit__day"),comment:document.querySelector(".habbit__comment")},main:{content:document.querySelector(".main__content")},nextDay:{title:document.getElementById("next-day")},popup:{content:document.querySelector(".cover"),iconFiled:document.querySelector('.popup__form input[name="icon"]')}};function loadData(){var e=localStorage.getItem(HABBIT_KEY),e=JSON.parse(e);Array.isArray(e)&&(habbits=e)}function saveData(){localStorage.setItem(HABBIT_KEY,JSON.stringify(habbits))}function togglePopup(){page.popup.content.classList.toggle("cover__hidden")}function resetForm(e,t){var r,n=_createForOfIteratorHelper(t);try{for(n.s();!(r=n.n()).done;)e[r.value].value=""}catch(e){n.e(e)}finally{n.f()}}function validateForm(e,t){var r,n=new FormData(e),o={},a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var i=r.value,c=n.get(i);e[i].classList.remove("error"),c||e[i].classList.add("error"),o[i]=c}}catch(e){a.e(e)}finally{a.f()}var u,l=!0,d=_createForOfIteratorHelper(t);try{for(d.s();!(u=d.n()).done;)o[u.value]||(l=!1)}catch(e){d.e(e)}finally{d.f()}if(l)return o}function rerenderMenu(n){var o,t=_createForOfIteratorHelper(habbits);try{for(t.s();!(o=t.n()).done;)(function(){var e,t=o.value,r=document.querySelector('[menu-habbit-id="'.concat(t.id,'"]'));if(!r)return(e=document.createElement("button")).setAttribute("menu-habbit-id",t.id),e.classList.add("menu__btn"),e.addEventListener("click",function(){return rerender(t.id)}),e.innerHTML='<img src="./assets/images/'.concat(t.icon,'.svg" alt="').concat(t.name,'" />'),n.id===t.id&&e.classList.add("menu__btn--active"),page.menu.appendChild(e);n.id===t.id?r.classList.add("menu__btn--active"):r.classList.remove("menu__btn--active")})()}catch(e){t.e(e)}finally{t.f()}}function rerenderHead(e){page.header.title.innerText=e.name;e=1<e.days.length/e.target?100:e.days.length/e.target*100;page.header.progressPersent.innerText=e.toFixed(0)+" %",page.header.progressCoverBar.setAttribute("style","width: ".concat(e,"%"))}function rerenderBody(e){page.main.content.innerHTML="",page.nextDay.title.innerHTML="День ".concat(e.days.length+1);var t,r,n,o,a=0,i=_createForOfIteratorHelper(e.days);try{for(i.s();!(t=i.n()).done;){var c=t.value;r=c,n=++a,o=void 0,(o=document.createElement("div")).classList.add("habbit"),r='\n    <div class="habbit__day">День '.concat(n,'</div>\n              <div class="habbit__comment">\n                ').concat(r.comment,'\n              </div>\n              <button class="delete" onclick="deleteDay(').concat(n,')">\n                <img src="./assets/images/delete.svg" alt="Удалить" />\n              </button>\n    '),o.innerHTML=r,page.main.content.appendChild(o)}}catch(e){i.e(e)}finally{i.f()}}function rerender(t){globalActiveHabbitId=t;var e=habbits.find(function(e){return e.id===t});e&&(document.location.replace(document.location.pathname+"#"+t),rerenderMenu(e),rerenderHead(e),rerenderBody(e))}function addDays(e){e.preventDefault();var t=validateForm(e.target,["comment"]);t&&(habbits=habbits.map(function(e){return e.id===globalActiveHabbitId?_objectSpread(_objectSpread({},e),{},{days:e.days.concat([{comment:t.comment}])}):e}),resetForm(e.target,["comment"]),rerender(globalActiveHabbitId),saveData())}function deleteDay(t){habbits=habbits.map(function(e){return e.id===globalActiveHabbitId?(e.days.splice(t-1,1),_objectSpread(_objectSpread({},e),{},{days:e.days})):e}),rerender(globalActiveHabbitId),saveData()}function setIcon(e,t){page.popup.iconFiled.value=t,document.querySelector(".icon.icon--active").classList.remove("icon--active"),e.classList.add("icon--active")}function addHabbit(e){e.preventDefault();var t,r=validateForm(e.target,["name","icon","target"]);r&&(t=habbits.reduce(function(e,t){return e>t.id?e:t.id},0),habbits.push({id:t+1,name:r.name,icon:r.icon,target:r.target,days:[]}),resetForm(e.target,["name","target"]),togglePopup(),saveData(),rerender(t+1))}!function(){loadData();var t=Number(document.location.hash.replace("#","")),e=habbits.find(function(e){return e.id===t});rerender((e||habbits[0]).id)}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZ2xvYmFsQWN0aXZlSGFiYml0SWQiLCJoYWJiaXRzIiwiSEFCQklUX0tFWSIsInBhZ2UiLCJtZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaGVhZGVyIiwidGl0bGUiLCJwcm9ncmVzc1BlcnNlbnQiLCJwcm9ncmVzc0NvdmVyQmFyIiwiYm9keSIsImRheSIsImNvbW1lbnQiLCJtYWluIiwiY29udGVudCIsIm5leHREYXkiLCJnZXRFbGVtZW50QnlJZCIsInBvcHVwIiwiaWNvbkZpbGVkIiwibG9hZERhdGEiLCJoYWJiaXRzU3RyaW5nIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImhhYmJpdEFycmF5IiwiSlNPTiIsInBhcnNlIiwiQXJyYXkiLCJpc0FycmF5Iiwic2F2ZURhdGEiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwidG9nZ2xlUG9wdXAiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZXNldEZvcm0iLCJmb3JtIiwiZmllbGRzIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIsInMiLCJuIiwiZG9uZSIsInZhbHVlIiwiZXJyIiwiZSIsImYiLCJ2YWxpZGF0ZUZvcm0iLCJfc3RlcDIiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwicmVzIiwiX2l0ZXJhdG9yMiIsImZpZWxkIiwiZmllbGRWYWx1ZSIsImdldCIsInJlbW92ZSIsImFkZCIsIl9zdGVwMyIsImlzVmFsaWQiLCJfaXRlcmF0b3IzIiwicmVyZW5kZXJNZW51IiwiYWN0aXZlSGFiYml0IiwiX3N0ZXA0IiwiX2l0ZXJhdG9yNCIsImVsZW1lbnQiLCJoYWJiaXQiLCJleGlzdGVkIiwiY29uY2F0IiwiaWQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlcmVuZGVyIiwiaW5uZXJIVE1MIiwiaWNvbiIsIm5hbWUiLCJhcHBlbmRDaGlsZCIsInJlcmVuZGVySGVhZCIsImlubmVyVGV4dCIsInByb2dyZXNzIiwiZGF5cyIsImxlbmd0aCIsInRhcmdldCIsInRvRml4ZWQiLCJyZXJlbmRlckJvZHkiLCJfc3RlcDUiLCJkYXlEYXRhIiwiZGF5TnVtYmVyIiwiaGFiYml0RWxlbWVudCIsIl9pdGVyYXRvcjUiLCJoYWJiaXRFbGVtZW50Q29udGVudCIsImFjdGl2ZUhhYmJpdElkIiwiZmluZCIsImxvY2F0aW9uIiwicmVwbGFjZSIsInBhdGhuYW1lIiwiYWRkRGF5cyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJkYXRhIiwibWFwIiwiX29iamVjdFNwcmVhZCIsImRlbGV0ZURheSIsInNwbGljZSIsInNldEljb24iLCJjb250ZXh0IiwiYWRkSGFiYml0IiwibWF4SWQiLCJyZWR1Y2UiLCJhY2MiLCJwdXNoIiwiaGFzaElkIiwiTnVtYmVyIiwiaGFzaCIsInVybEhhYmJpdCJdLCJtYXBwaW5ncyI6Im0rRUFBQSxJQUVBQSxxQkFGQUMsUUFBQSxHQUNBQyxXQUFBLGFBS0FDLEtBQUEsQ0FDQUMsS0FBQUMsU0FBQUMsY0FBQSxhQUFBLEVBQ0FDLE9BQUEsQ0FDQUMsTUFBQUgsU0FBQUMsY0FBQSxnQkFBQSxFQUNBRyxnQkFBQUosU0FBQUMsY0FBQSxvQkFBQSxFQUNBSSxpQkFBQUwsU0FBQUMsY0FBQSxzQkFBQSxDQUNBLEVBQ0FLLEtBQUEsQ0FDQUMsSUFBQVAsU0FBQUMsY0FBQSxjQUFBLEVBQ0FPLFFBQUFSLFNBQUFDLGNBQUEsa0JBQUEsQ0FDQSxFQUNBUSxLQUFBLENBQ0FDLFFBQUFWLFNBQUFDLGNBQUEsZ0JBQUEsQ0FDQSxFQUNBVSxRQUFBLENBQ0FSLE1BQUFILFNBQUFZLGVBQUEsVUFBQSxDQUNBLEVBQ0FDLE1BQUEsQ0FDQUgsUUFBQVYsU0FBQUMsY0FBQSxRQUFBLEVBQ0FhLFVBQUFkLFNBQUFDLGNBQ0EsaUNBQUEsQ0FFQSxDQUNBLEVBSUEsU0FBQWMsV0FDQSxJQUFBQyxFQUFBQyxhQUFBQyxRQUFBckIsVUFBQSxFQUNBc0IsRUFBQUMsS0FBQUMsTUFB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QXlCLElBQUEsY0FBQSxDQUNBLENBRUEsU0FBQWtELFVBQUFULEdBQ0FBLEVBQUFDLGVBQUEsRUFDQSxJQUlBUyxFQUpBUixFQUFBckQsYUFBQW1ELEVBQUFmLE9BQUEsQ0FBQSxPQUFBLE9BQUEsU0FBQSxFQUNBaUIsSUFHQVEsRUFBQTVHLFFBQUE2RyxPQUNBLFNBQUFDLEVBQUE1QyxHQUFBLE9BQUE0QyxFQUFBNUMsRUFBQUcsR0FBQXlDLEVBQUE1QyxFQUFBRyxFQUFBLEVBQ0EsQ0FBQSxFQUVBckUsUUFBQStHLEtBQUEsQ0FDQTFDLEdBQUF1QyxFQUFBLEVBQ0FoQyxLQUFBd0IsRUFBQXhCLEtBQ0FELEtBQUF5QixFQUFBekIsS0FDQVEsT0FBQWlCLEVBQUFqQixPQUNBRixLQUFBLEVBQ0EsQ0FBQSxFQUNBL0MsVUFBQWdFLEVBQUFmLE9BQUEsQ0FBQSxPQUFBLFNBQUEsRUFDQXBELFlBQUEsRUFDQUgsU0FBQSxFQUNBNkMsU0FBQW1DLEVBQUEsQ0FBQSxFQUNBLENBSUEsQ0FBQSxXQUNBekYsU0FBQSxFQUNBLElBQUE2RixFQUFBQyxPQUFBN0csU0FBQTBGLFNBQUFvQixLQUFBbkIsUUFBQSxJQUFBLEVBQUEsQ0FBQSxFQUNBb0IsRUFBQW5ILFFBQUE2RixLQUFBLFNBQUEzQixHQUFBLE9BQUFBLEVBQUFHLEtBQUEyQyxDQUFBLENBQUEsRUFFQXZDLFVBREEwQyxHQUdBbkgsUUFBQSxJQUZBcUUsRUFBQSxDQUlBLEVBQUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImxldCBoYWJiaXRzID0gW107XG5jb25zdCBIQUJCSVRfS0VZID0gJ0hBQkJJVF9LRVknO1xubGV0IGdsb2JhbEFjdGl2ZUhhYmJpdElkO1xuXG4vL3BhZ2VcblxuY29uc3QgcGFnZSA9IHtcbiAgbWVudTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1lbnVfX2xpc3QnKSxcbiAgaGVhZGVyOiB7XG4gICAgdGl0bGU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX3RpdGxlJyksXG4gICAgcHJvZ3Jlc3NQZXJzZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZ3Jlc3NfX3BlcmNlbnQnKSxcbiAgICBwcm9ncmVzc0NvdmVyQmFyOiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZ3Jlc3NfX2NvdmVyLWJhcicpLFxuICB9LFxuICBib2R5OiB7XG4gICAgZGF5OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGFiYml0X19kYXknKSxcbiAgICBjb21tZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGFiYml0X19jb21tZW50JyksXG4gIH0sXG4gIG1haW46IHtcbiAgICBjb250ZW50OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbl9fY29udGVudCcpLFxuICB9LFxuICBuZXh0RGF5OiB7XG4gICAgdGl0bGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduZXh0LWRheScpLFxuICB9LFxuICBwb3B1cDoge1xuICAgIGNvbnRlbnQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb3ZlcicpLFxuICAgIGljb25GaWxlZDogZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICcucG9wdXBfX2Zvcm0gaW5wdXRbbmFtZT1cImljb25cIl0nXG4gICAgKSxcbiAgfSxcbn07XG5cbi8vdXRpbHNcblxuZnVuY3Rpb24gbG9hZERhdGEoKSB7XG4gIGNvbnN0IGhhYmJpdHNTdHJpbmcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShIQUJCSVRfS0VZKTtcbiAgY29uc3QgaGFiYml0QXJyYXkgPSBKU09OLnBhcnNlKGhhYmJpdHNTdHJpbmcpO1xuICBpZiAoQXJyYXkuaXNBcnJheShoYWJiaXRBcnJheSkpIHtcbiAgICBoYWJiaXRzID0gaGFiYml0QXJyYXk7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2F2ZURhdGEoKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKEhBQkJJVF9LRVksIEpTT04uc3RyaW5naWZ5KGhhYmJpdHMpKTtcbn1cblxuZnVuY3Rpb24gdG9nZ2xlUG9wdXAoKSB7XG4gIHBhZ2UucG9wdXAuY29udGVudC5jbGFzc0xpc3QudG9nZ2xlKCdjb3Zlcl9faGlkZGVuJyk7XG59XG5cbmZ1bmN0aW9uIHJlc2V0Rm9ybShmb3JtLCBmaWVsZHMpIHtcbiAgZm9yIChjb25zdCBmaWVsZCBvZiBmaWVsZHMpIHtcbiAgICBmb3JtW2ZpZWxkXS52YWx1ZSA9ICcnO1xuICB9XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlRm9ybShmb3JtLCBmaWVsZHMpIHtcbiAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoZm9ybSk7XG4gIGNvbnN0IHJlcyA9IHt9O1xuICBmb3IgKGNvbnN0IGZpZWxkIG9mIGZpZWxkcykge1xuICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBmb3JtRGF0YS5nZXQoZmllbGQpO1xuICAgIGZvcm1bZmllbGRdLmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XG4gICAgaWYgKCFmaWVsZFZhbHVlKSB7XG4gICAgICBmb3JtW2ZpZWxkXS5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuICAgIH1cbiAgICByZXNbZmllbGRdID0gZmllbGRWYWx1ZTtcbiAgfVxuICBsZXQgaXNWYWxpZCA9IHRydWU7XG4gIGZvciAoY29uc3QgZmllbGQgb2YgZmllbGRzKSB7XG4gICAgaWYgKCFyZXNbZmllbGRdKSB7XG4gICAgICBpc1ZhbGlkID0gZmFsc2U7XG4gICAgfVxuICB9XG4gIGlmICghaXNWYWxpZCkge1xuICAgIHJldHVybjtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuXG4vL3JlbmRlclxuXG5mdW5jdGlvbiByZXJlbmRlck1lbnUoYWN0aXZlSGFiYml0KSB7XG4gIGZvciAoY29uc3QgaGFiYml0IG9mIGhhYmJpdHMpIHtcbiAgICBjb25zdCBleGlzdGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGBbbWVudS1oYWJiaXQtaWQ9XCIke2hhYmJpdC5pZH1cIl1gXG4gICAgKTtcbiAgICBpZiAoIWV4aXN0ZWQpIHtcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdtZW51LWhhYmJpdC1pZCcsIGhhYmJpdC5pZCk7XG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21lbnVfX2J0bicpO1xuICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHJlcmVuZGVyKGhhYmJpdC5pZCkpO1xuICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBgPGltZyBzcmM9XCIuL2Fzc2V0cy9pbWFnZXMvJHtoYWJiaXQuaWNvbn0uc3ZnXCIgYWx0PVwiJHtoYWJiaXQubmFtZX1cIiAvPmA7XG4gICAgICBpZiAoYWN0aXZlSGFiYml0LmlkID09PSBoYWJiaXQuaWQpIHtcbiAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdtZW51X19idG4tLWFjdGl2ZScpO1xuICAgICAgfVxuICAgICAgcGFnZS5tZW51LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChhY3RpdmVIYWJiaXQuaWQgPT09IGhhYmJpdC5pZCkge1xuICAgICAgZXhpc3RlZC5jbGFzc0xpc3QuYWRkKCdtZW51X19idG4tLWFjdGl2ZScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBleGlzdGVkLmNsYXNzTGlzdC5yZW1vdmUoJ21lbnVfX2J0bi0tYWN0aXZlJyk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHJlcmVuZGVySGVhZChhY3RpdmVIYWJiaXQpIHtcbiAgcGFnZS5oZWFkZXIudGl0bGUuaW5uZXJUZXh0ID0gYWN0aXZlSGFiYml0Lm5hbWU7XG4gIGNvbnN0IHByb2dyZXNzID1cbiAgICBhY3RpdmVIYWJiaXQuZGF5cy5sZW5ndGggLyBhY3RpdmVIYWJiaXQudGFyZ2V0ID4gMVxuICAgICAgPyAxMDBcbiAgICAgIDogKGFjdGl2ZUhhYmJpdC5kYXlzLmxlbmd0aCAvIGFjdGl2ZUhhYmJpdC50YXJnZXQpICogMTAwO1xuICBwYWdlLmhlYWRlci5wcm9ncmVzc1BlcnNlbnQuaW5uZXJUZXh0ID0gcHJvZ3Jlc3MudG9GaXhlZCgwKSArICcgJSc7XG4gIHBhZ2UuaGVhZGVyLnByb2dyZXNzQ292ZXJCYXIuc2V0QXR0cmlidXRlKFxuICAgICdzdHlsZScsXG4gICAgYHdpZHRoOiAke3Byb2dyZXNzfSVgXG4gICk7XG59XG5cbmZ1bmN0aW9uIHJlcmVuZGVyQm9keShhY3RpdmVIYWJiaXQpIHtcbiAgcGFnZS5tYWluLmNvbnRlbnQuaW5uZXJIVE1MID0gJyc7XG4gIHBhZ2UubmV4dERheS50aXRsZS5pbm5lckhUTUwgPSBg0JTQtdC90YwgJHtcbiAgICBhY3RpdmVIYWJiaXQuZGF5cy5sZW5ndGggKyAxXG4gIH1gO1xuXG4gIGxldCBkYXlOdW1iZXIgPSAwO1xuXG4gIGZvciAobGV0IGRheSBvZiBhY3RpdmVIYWJiaXQuZGF5cykge1xuICAgICsrZGF5TnVtYmVyO1xuICAgIHJlbmRlckJvZHlFbGVtZW50KGRheSwgZGF5TnVtYmVyKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlbmRlckJvZHlFbGVtZW50KGRheURhdGEsIGRheU51bWJlcikge1xuICAgIGNvbnN0IGhhYmJpdEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBoYWJiaXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2hhYmJpdCcpO1xuXG4gICAgY29uc3QgaGFiYml0RWxlbWVudENvbnRlbnQgPSBgXG4gICAgPGRpdiBjbGFzcz1cImhhYmJpdF9fZGF5XCI+0JTQtdC90YwgJHtkYXlOdW1iZXJ9PC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJoYWJiaXRfX2NvbW1lbnRcIj5cbiAgICAgICAgICAgICAgICAke2RheURhdGEuY29tbWVudH1cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJkZWxldGVcIiBvbmNsaWNrPVwiZGVsZXRlRGF5KCR7ZGF5TnVtYmVyfSlcIj5cbiAgICAgICAgICAgICAgICA8aW1nIHNyYz1cIi4vYXNzZXRzL2ltYWdlcy9kZWxldGUuc3ZnXCIgYWx0PVwi0KPQtNCw0LvQuNGC0YxcIiAvPlxuICAgICAgICAgICAgICA8L2J1dHRvbj5cbiAgICBgO1xuXG4gICAgaGFiYml0RWxlbWVudC5pbm5lckhUTUwgPSBoYWJiaXRFbGVtZW50Q29udGVudDtcbiAgICBwYWdlLm1haW4uY29udGVudC5hcHBlbmRDaGlsZChoYWJiaXRFbGVtZW50KTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZXJlbmRlcihhY3RpdmVIYWJiaXRJZCkge1xuICBnbG9iYWxBY3RpdmVIYWJiaXRJZCA9IGFjdGl2ZUhhYmJpdElkO1xuICBjb25zdCBhY3RpdmVIYWJiaXQgPSBoYWJiaXRzLmZpbmQoXG4gICAgKGhhYmJpdCkgPT4gaGFiYml0LmlkID09PSBhY3RpdmVIYWJiaXRJZFxuICApO1xuICBpZiAoIWFjdGl2ZUhhYmJpdCkge1xuICAgIHJldHVybjtcbiAgfVxuICBkb2N1bWVudC5sb2NhdGlvbi5yZXBsYWNlKFxuICAgIGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lICsgJyMnICsgYWN0aXZlSGFiYml0SWRcbiAgKTtcbiAgcmVyZW5kZXJNZW51KGFjdGl2ZUhhYmJpdCk7XG4gIHJlcmVuZGVySGVhZChhY3RpdmVIYWJiaXQpO1xuICByZXJlbmRlckJvZHkoYWN0aXZlSGFiYml0KTtcbn1cblxuLy93b3JrIHdpdGggZGF5c1xuXG5mdW5jdGlvbiBhZGREYXlzKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGRhdGEgPSB2YWxpZGF0ZUZvcm0oZXZlbnQudGFyZ2V0LCBbJ2NvbW1lbnQnXSk7XG4gIGlmICghZGF0YSkge1xuICAgIHJldHVybjtcbiAgfVxuICBoYWJiaXRzID0gaGFiYml0cy5tYXAoKGhhYmJpdCkgPT4ge1xuICAgIGlmIChoYWJiaXQuaWQgPT09IGdsb2JhbEFjdGl2ZUhhYmJpdElkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5oYWJiaXQsXG4gICAgICAgIGRheXM6IGhhYmJpdC5kYXlzLmNvbmNhdChbeyBjb21tZW50OiBkYXRhLmNvbW1lbnQgfV0pLFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGhhYmJpdDtcbiAgfSk7XG4gIHJlc2V0Rm9ybShldmVudC50YXJnZXQsIFsnY29tbWVudCddKTtcbiAgcmVyZW5kZXIoZ2xvYmFsQWN0aXZlSGFiYml0SWQpO1xuICBzYXZlRGF0YSgpO1xufVxuXG4vL2RlbGV0ZVxuXG5mdW5jdGlvbiBkZWxldGVEYXkoZGF5TnVtYmVyKSB7XG4gIGhhYmJpdHMgPSBoYWJiaXRzLm1hcCgoaGFiYml0KSA9PiB7XG4gICAgaWYgKGhhYmJpdC5pZCA9PT0gZ2xvYmFsQWN0aXZlSGFiYml0SWQpIHtcbiAgICAgIGhhYmJpdC5kYXlzLnNwbGljZShkYXlOdW1iZXIgLSAxLCAxKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmhhYmJpdCxcbiAgICAgICAgZGF5czogaGFiYml0LmRheXMsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gaGFiYml0O1xuICB9KTtcbiAgcmVyZW5kZXIoZ2xvYmFsQWN0aXZlSGFiYml0SWQpO1xuICBzYXZlRGF0YSgpO1xufVxuXG4vL3dvcmtpbmcgd2l0aCBoYWJiaXRzXG5cbmZ1bmN0aW9uIHNldEljb24oY29udGV4dCwgaWNvbikge1xuICBwYWdlLnBvcHVwLmljb25GaWxlZC52YWx1ZSA9IGljb247XG4gIGNvbnN0IGFjdGl2ZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaWNvbi5pY29uLS1hY3RpdmUnKTtcbiAgYWN0aXZlSWNvbi5jbGFzc0xpc3QucmVtb3ZlKCdpY29uLS1hY3RpdmUnKTtcbiAgY29udGV4dC5jbGFzc0xpc3QuYWRkKCdpY29uLS1hY3RpdmUnKTtcbn1cblxuZnVuY3Rpb24gYWRkSGFiYml0KGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IGRhdGEgPSB2YWxpZGF0ZUZvcm0oZXZlbnQudGFyZ2V0LCBbJ25hbWUnLCAnaWNvbicsICd0YXJnZXQnXSk7XG4gIGlmICghZGF0YSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBtYXhJZCA9IGhhYmJpdHMucmVkdWNlKFxuICAgIChhY2MsIGhhYmJpdCkgPT4gKGFjYyA+IGhhYmJpdC5pZCA/IGFjYyA6IGhhYmJpdC5pZCksXG4gICAgMFxuICApO1xuICBoYWJiaXRzLnB1c2goe1xuICAgIGlkOiBtYXhJZCArIDEsXG4gICAgbmFtZTogZGF0YS5uYW1lLFxuICAgIGljb246IGRhdGEuaWNvbixcbiAgICB0YXJnZXQ6IGRhdGEudGFyZ2V0LFxuICAgIGRheXM6IFtdLFxuICB9KTtcbiAgcmVzZXRGb3JtKGV2ZW50LnRhcmdldCwgWyduYW1lJywgJ3RhcmdldCddKTtcbiAgdG9nZ2xlUG9wdXAoKTtcbiAgc2F2ZURhdGEoKTtcbiAgcmVyZW5kZXIobWF4SWQgKyAxKTtcbn1cblxuLy9pbml0XG5cbigoKSA9PiB7XG4gIGxvYWREYXRhKCk7XG4gIGNvbnN0IGhhc2hJZCA9IE51bWJlcihkb2N1bWVudC5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoJyMnLCAnJykpO1xuICBjb25zdCB1cmxIYWJiaXQgPSBoYWJiaXRzLmZpbmQoKGhhYmJpdCkgPT4gaGFiYml0LmlkID09PSBoYXNoSWQpO1xuICBpZiAodXJsSGFiYml0KSB7XG4gICAgcmVyZW5kZXIodXJsSGFiYml0LmlkKTtcbiAgfSBlbHNlIHtcbiAgICByZXJlbmRlcihoYWJiaXRzWzBdLmlkKTtcbiAgfVxufSkoKTtcbiJdfQ==
