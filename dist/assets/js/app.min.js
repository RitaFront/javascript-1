"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}function _createForOfIteratorHelper(e,t){var r,n,o,a,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return n=!(r=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return r=e.done,e},e:function(e){n=!0,o=e},f:function(){try{r||null==i.return||i.return()}finally{if(n)throw o}}};if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length)return i&&(e=i),a=0,{s:t=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){var r;if(e)return"string"==typeof e?_arrayLikeToArray(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var globalActiveHabbitId,habbits=[],HABBIT_KEY="HABBIT_KEY",page={menu:document.querySelector(".menu__list"),header:{title:document.querySelector(".header__title"),progressPersent:document.querySelector(".progress__percent"),progressCoverBar:document.querySelector(".progress__cover-bar")},body:{day:document.querySelector(".habbit__day"),comment:document.querySelector(".habbit__comment")},main:{content:document.querySelector(".main__content")},nextDay:{title:document.getElementById("next-day")}};function loadData(){var e=localStorage.getItem(HABBIT_KEY),e=JSON.parse(e);Array.isArray(e)&&(habbits=e)}function saveData(){localStorage.setItem(HABBIT_KEY,JSON.stringify(habbits))}function rerenderMenu(n){var o,t=_createForOfIteratorHelper(habbits);try{for(t.s();!(o=t.n()).done;)(function(){var e,t=o.value,r=document.querySelector('[menu-habbit-id="'.concat(t.id,'"]'));if(!r)return(e=document.createElement("button")).setAttribute("menu-habbit-id",t.id),e.classList.add("menu__btn"),e.addEventListener("click",function(){return rerender(t.id)}),e.innerHTML='<img src="./assets/images/'.concat(t.icon,'.svg" alt="').concat(t.name,'" />'),n.id===t.id&&e.classList.add("menu__btn--active"),page.menu.appendChild(e);n.id===t.id?r.classList.add("menu__btn--active"):r.classList.remove("menu__btn--active")})()}catch(e){t.e(e)}finally{t.f()}}function rerenderHead(e){page.header.title.innerText=e.name;e=1<e.days.length/e.target?100:e.days.length/e.target*100;page.header.progressPersent.innerText=e.toFixed(0)+" %",page.header.progressCoverBar.setAttribute("style","width: ".concat(e,"%"))}function rerenderBody(e){page.main.content.innerHTML="",page.nextDay.title.innerHTML="День ".concat(e.days.length+1);var t,r,n,o,a=0,i=_createForOfIteratorHelper(e.days);try{for(i.s();!(t=i.n()).done;){var c=t.value;r=c,n=++a,o=void 0,(o=document.createElement("div")).classList.add("habbit"),r='\n    <div class="habbit__day">День '.concat(n,'</div>\n              <div class="habbit__comment">\n                ').concat(r.comment,'\n              </div>\n              <button class="delete" onclick="deleteDay(').concat(n,')">\n                <img src="./assets/images/delete.svg" alt="Удалить" />\n              </button>\n    '),o.innerHTML=r,page.main.content.appendChild(o)}}catch(e){i.e(e)}finally{i.f()}}function rerender(t){globalActiveHabbitId=t;var e=habbits.find(function(e){return e.id===t});e&&(rerenderMenu(e),rerenderHead(e),rerenderBody(e))}function addDays(e){var t=e.target;e.preventDefault();var r=new FormData(t).get("comment");t.comment.classList.remove("error"),r||t.comment.classList.add("error"),habbits=habbits.map(function(e){return e.id===globalActiveHabbitId?_objectSpread(_objectSpread({},e),{},{days:e.days.concat({comment:r})}):e}),t.comment.value="",rerender(globalActiveHabbitId),saveData()}function deleteDay(t){habbits=habbits.map(function(e){return e.id===globalActiveHabbitId?(e.days.splice(t-1,1),_objectSpread(_objectSpread({},e),{},{days:e.days})):e}),rerender(globalActiveHabbitId),saveData()}loadData(),rerender(habbits[0].id);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZ2xvYmFsQWN0aXZlSGFiYml0SWQiLCJoYWJiaXRzIiwiSEFCQklUX0tFWSIsInBhZ2UiLCJtZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaGVhZGVyIiwidGl0bGUiLCJwcm9ncmVzc1BlcnNlbnQiLCJwcm9ncmVzc0NvdmVyQmFyIiwiYm9keSIsImRheSIsImNvbW1lbnQiLCJtYWluIiwiY29udGVudCIsIm5leHREYXkiLCJnZXRFbGVtZW50QnlJZCIsImxvYWREYXRhIiwiaGFiYml0c1N0cmluZyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJoYWJiaXRBcnJheSIsIkpTT04iLCJwYXJzZSIsIkFycmF5IiwiaXNBcnJheSIsInNhdmVEYXRhIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInJlcmVuZGVyTWVudSIsImFjdGl2ZUhhYmJpdCIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIiLCJzIiwibiIsImRvbmUiLCJlbGVtZW50IiwiaGFiYml0IiwidmFsdWUiLCJleGlzdGVkIiwiY29uY2F0IiwiaWQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlcmVuZGVyIiwiaW5uZXJIVE1MIiwiaWNvbiIsIm5hbWUiLCJhcHBlbmRDaGlsZCIsInJlbW92ZSIsImVyciIsImUiLCJmIiwicmVyZW5kZXJIZWFkIiwiaW5uZXJUZXh0IiwicHJvZ3Jlc3MiLCJkYXlzIiwibGVuZ3RoIiwidGFyZ2V0IiwidG9GaXhlZCIsInJlcmVuZGVyQm9keSIsIl9zdGVwMiIsImRheURhdGEiLCJkYXlOdW1iZXIiLCJoYWJiaXRFbGVtZW50IiwiX2l0ZXJhdG9yMiIsImhhYmJpdEVsZW1lbnRDb250ZW50IiwiYWN0aXZlSGFiYml0SWQiLCJmaW5kIiwiYWRkRGF5cyIsImV2ZW50IiwiZm9ybSIsInByZXZlbnREZWZhdWx0IiwiRm9ybURhdGEiLCJnZXQiLCJtYXAiLCJfb2JqZWN0U3ByZWFkIiwiZGVsZXRlRGF5Iiwic3BsaWNlIl0sIm1hcHBpbmdzIjoibStFQUFBLElBRUFBLHFCQUZBQyxRQUFBLEdBQ0FDLFdBQUEsYUFLQUMsS0FBQSxDQUNBQyxLQUFBQyxTQUFBQyxjQUFBLGFBQUEsRUFDQUMsT0FBQSxDQUNBQyxNQUFBSCxTQUFBQyxjQUFBLGdCQUFBLEVBQ0FHLGdCQUFBSixTQUFBQyxjQUFBLG9CQUFBLEVBQ0FJLGlCQUFBTCxTQUFBQyxjQUFBLHNCQUFBLENBQ0EsRUFDQUssS0FBQSxDQUNBQyxJQUFBUCxTQUFBQyxjQUFBLGNBQUEsRUFDQU8sUUFBQVIsU0FBQUMsY0FBQSxrQkFBQSxDQUNBLEVBQ0FRLEtBQUEsQ0FDQUMsUUFBQVYsU0FBQUMsY0FBQSxnQkFBQSxDQUNBLEVBQ0FVLFFBQUEsQ0FDQVIsTUFBQUgsU0FBQVksZUFBQSxVQUFBLENBQ0EsQ0FDQSxFQUlBLFNBQUFDLFdBQ0EsSUFBQUMsRUFBQUMsYUFBQUMsUUFBQW5CLFVBQUEsRUFDQW9CLEVBQUFDLEtBQUFDLE1BQUFMLENBQUEsRUFDQU0sTUFBQUMsUUFBQUosQ0FBQSxJQUNBckIsUUFBQXFCLEVBRUEsQ0FFQSxTQUFBSyxXQUNBUCxhQUFBUSxRQUFBMUIsV0FBQXFCLEtBQUFNLFVBQUE1QixPQUFBLENBQUEsQ0FDQSxDQUlBLFNBQUE2QixhQUFBQyxHQUFBLElBQ0FDLEVBREFDLEVBQUFDLDJCQUNBakMsT0FBQSxFQUFBLElBQUEsSUFBQWdDLEVBQUFFLEVBQUEsRUFBQSxFQUFBSCxFQUFBQyxFQUFBRyxFQUFBLEdBQUFDLE9BQUEsV0FBQSxJQUtBQyxFQUxBQyxFQUFBUCxFQUFBUSxNQUNBQyxFQUFBcEMsU0FBQUMsY0FBQSxvQkFBQW9DLE9BQ0FILEVBQUFJLEdBQUEsSUFBQSxDQUFBLEVBRUEsR0FBQSxDQUFBRixFQVNBLE9BUkFILEVBQUFqQyxTQUFBdUMsY0FBQSxRQUFBLEdBQ0FDLGFBQUEsaUJBQUFOLEVBQUFJLEVBQUEs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Q0FBQTdCLFFBQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsRUFHQTBCLENBQ0EsQ0FBQSxFQUNBcUMsRUFBQSxRQUFBcEMsTUFBQSxHQUNBUyxTQUFBakQsb0JBQUEsRUFDQTJCLFNBQUEsQ0FDQSxDQUlBLFNBQUF1RCxVQUFBZCxHQUNBbkUsUUFBQUEsUUFBQStFLElBQUEsU0FBQXpDLEdBQ0EsT0FBQUEsRUFBQUksS0FBQTNDLHNCQUNBdUMsRUFBQXNCLEtBQUFzQixPQUFBZixFQUFBLEVBQUEsQ0FBQSxFQUNBYSxjQUFBQSxjQUFBLEdBQ0ExQyxDQUFBLEVBQUEsR0FBQSxDQUNBc0IsS0FBQXRCLEVBQUFzQixJQUFBLENBQUEsR0FHQXRCLENBQ0EsQ0FBQSxFQUNBVSxTQUFBakQsb0JBQUEsRUFDQTJCLFNBQUEsQ0FDQSxDQUtBVCxTQUFBLEVBQ0ErQixTQUFBaEQsUUFBQSxHQUFBMEMsRUFBQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsibGV0IGhhYmJpdHMgPSBbXTtcbmNvbnN0IEhBQkJJVF9LRVkgPSAnSEFCQklUX0tFWSc7XG5sZXQgZ2xvYmFsQWN0aXZlSGFiYml0SWQ7XG5cbi8vcGFnZVxuXG5jb25zdCBwYWdlID0ge1xuICBtZW51OiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudV9fbGlzdCcpLFxuICBoZWFkZXI6IHtcbiAgICB0aXRsZTogZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fdGl0bGUnKSxcbiAgICBwcm9ncmVzc1BlcnNlbnQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9ncmVzc19fcGVyY2VudCcpLFxuICAgIHByb2dyZXNzQ292ZXJCYXI6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9ncmVzc19fY292ZXItYmFyJyksXG4gIH0sXG4gIGJvZHk6IHtcbiAgICBkYXk6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oYWJiaXRfX2RheScpLFxuICAgIGNvbW1lbnQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oYWJiaXRfX2NvbW1lbnQnKSxcbiAgfSxcbiAgbWFpbjoge1xuICAgIGNvbnRlbnQ6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluX19jb250ZW50JyksXG4gIH0sXG4gIG5leHREYXk6IHtcbiAgICB0aXRsZTogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHQtZGF5JyksXG4gIH0sXG59O1xuXG4vL3V0aWxzXG5cbmZ1bmN0aW9uIGxvYWREYXRhKCkge1xuICBjb25zdCBoYWJiaXRzU3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oSEFCQklUX0tFWSk7XG4gIGNvbnN0IGhhYmJpdEFycmF5ID0gSlNPTi5wYXJzZShoYWJiaXRzU3RyaW5nKTtcbiAgaWYgKEFycmF5LmlzQXJyYXkoaGFiYml0QXJyYXkpKSB7XG4gICAgaGFiYml0cyA9IGhhYmJpdEFycmF5O1xuICB9XG59XG5cbmZ1bmN0aW9uIHNhdmVEYXRhKCkge1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShIQUJCSVRfS0VZLCBKU09OLnN0cmluZ2lmeShoYWJiaXRzKSk7XG59XG5cbi8vcmVuZGVyXG5cbmZ1bmN0aW9uIHJlcmVuZGVyTWVudShhY3RpdmVIYWJiaXQpIHtcbiAgZm9yIChjb25zdCBoYWJiaXQgb2YgaGFiYml0cykge1xuICAgIGNvbnN0IGV4aXN0ZWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYFttZW51LWhhYmJpdC1pZD1cIiR7aGFiYml0LmlkfVwiXWBcbiAgICApO1xuICAgIGlmICghZXhpc3RlZCkge1xuICAgICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ21lbnUtaGFiYml0LWlkJywgaGFiYml0LmlkKTtcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnbWVudV9fYnRuJyk7XG4gICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gcmVyZW5kZXIoaGFiYml0LmlkKSk7XG4gICAgICBlbGVtZW50LmlubmVySFRNTCA9IGA8aW1nIHNyYz1cIi4vYXNzZXRzL2ltYWdlcy8ke2hhYmJpdC5pY29ufS5zdmdcIiBhbHQ9XCIke2hhYmJpdC5uYW1lfVwiIC8+YDtcbiAgICAgIGlmIChhY3RpdmVIYWJiaXQuaWQgPT09IGhhYmJpdC5pZCkge1xuICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoJ21lbnVfX2J0bi0tYWN0aXZlJyk7XG4gICAgICB9XG4gICAgICBwYWdlLm1lbnUuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgaWYgKGFjdGl2ZUhhYmJpdC5pZCA9PT0gaGFiYml0LmlkKSB7XG4gICAgICBleGlzdGVkLmNsYXNzTGlzdC5hZGQoJ21lbnVfX2J0bi0tYWN0aXZlJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGV4aXN0ZWQuY2xhc3NMaXN0LnJlbW92ZSgnbWVudV9fYnRuLS1hY3RpdmUnKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVyZW5kZXJIZWFkKGFjdGl2ZUhhYmJpdCkge1xuICBwYWdlLmhlYWRlci50aXRsZS5pbm5lclRleHQgPSBhY3RpdmVIYWJiaXQubmFtZTtcbiAgY29uc3QgcHJvZ3Jlc3MgPVxuICAgIGFjdGl2ZUhhYmJpdC5kYXlzLmxlbmd0aCAvIGFjdGl2ZUhhYmJpdC50YXJnZXQgPiAxXG4gICAgICA/IDEwMFxuICAgICAgOiAoYWN0aXZlSGFiYml0LmRheXMubGVuZ3RoIC8gYWN0aXZlSGFiYml0LnRhcmdldCkgKiAxMDA7XG4gIHBhZ2UuaGVhZGVyLnByb2dyZXNzUGVyc2VudC5pbm5lclRleHQgPSBwcm9ncmVzcy50b0ZpeGVkKDApICsgJyAlJztcbiAgcGFnZS5oZWFkZXIucHJvZ3Jlc3NDb3ZlckJhci5zZXRBdHRyaWJ1dGUoXG4gICAgJ3N0eWxlJyxcbiAgICBgd2lkdGg6ICR7cHJvZ3Jlc3N9JWBcbiAgKTtcbn1cblxuZnVuY3Rpb24gcmVyZW5kZXJCb2R5KGFjdGl2ZUhhYmJpdCkge1xuICBwYWdlLm1haW4uY29udGVudC5pbm5lckhUTUwgPSAnJztcbiAgcGFnZS5uZXh0RGF5LnRpdGxlLmlubmVySFRNTCA9IGDQlNC10L3RjCAke1xuICAgIGFjdGl2ZUhhYmJpdC5kYXlzLmxlbmd0aCArIDFcbiAgfWA7XG5cbiAgbGV0IGRheU51bWJlciA9IDA7XG5cbiAgZm9yIChsZXQgZGF5IG9mIGFjdGl2ZUhhYmJpdC5kYXlzKSB7XG4gICAgKytkYXlOdW1iZXI7XG4gICAgcmVuZGVyQm9keUVsZW1lbnQoZGF5LCBkYXlOdW1iZXIpO1xuICB9XG5cbiAgZnVuY3Rpb24gcmVuZGVyQm9keUVsZW1lbnQoZGF5RGF0YSwgZGF5TnVtYmVyKSB7XG4gICAgY29uc3QgaGFiYml0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGhhYmJpdEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnaGFiYml0Jyk7XG5cbiAgICBjb25zdCBoYWJiaXRFbGVtZW50Q29udGVudCA9IGBcbiAgICA8ZGl2IGNsYXNzPVwiaGFiYml0X19kYXlcIj7QlNC10L3RjCAke2RheU51bWJlcn08L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImhhYmJpdF9fY29tbWVudFwiPlxuICAgICAgICAgICAgICAgICR7ZGF5RGF0YS5jb21tZW50fVxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImRlbGV0ZVwiIG9uY2xpY2s9XCJkZWxldGVEYXkoJHtkYXlOdW1iZXJ9KVwiPlxuICAgICAgICAgICAgICAgIDxpbWcgc3JjPVwiLi9hc3NldHMvaW1hZ2VzL2RlbGV0ZS5zdmdcIiBhbHQ9XCLQo9C00LDQu9C40YLRjFwiIC8+XG4gICAgICAgICAgICAgIDwvYnV0dG9uPlxuICAgIGA7XG5cbiAgICBoYWJiaXRFbGVtZW50LmlubmVySFRNTCA9IGhhYmJpdEVsZW1lbnRDb250ZW50O1xuICAgIHBhZ2UubWFpbi5jb250ZW50LmFwcGVuZENoaWxkKGhhYmJpdEVsZW1lbnQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlcmVuZGVyKGFjdGl2ZUhhYmJpdElkKSB7XG4gIGdsb2JhbEFjdGl2ZUhhYmJpdElkID0gYWN0aXZlSGFiYml0SWQ7XG4gIGNvbnN0IGFjdGl2ZUhhYmJpdCA9IGhhYmJpdHMuZmluZChcbiAgICAoaGFiYml0KSA9PiBoYWJiaXQuaWQgPT09IGFjdGl2ZUhhYmJpdElkXG4gICk7XG4gIGlmICghYWN0aXZlSGFiYml0KSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHJlcmVuZGVyTWVudShhY3RpdmVIYWJiaXQpO1xuICByZXJlbmRlckhlYWQoYWN0aXZlSGFiYml0KTtcbiAgcmVyZW5kZXJCb2R5KGFjdGl2ZUhhYmJpdCk7XG59XG5cbi8vd29yayB3aXRoIGRheXNcblxuZnVuY3Rpb24gYWRkRGF5cyhldmVudCkge1xuICBjb25zdCBmb3JtID0gZXZlbnQudGFyZ2V0O1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBkYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xuICBjb25zdCBjb21tZW50ID0gZGF0YS5nZXQoJ2NvbW1lbnQnKTtcbiAgZm9ybVsnY29tbWVudCddLmNsYXNzTGlzdC5yZW1vdmUoJ2Vycm9yJyk7XG4gIGlmICghY29tbWVudCkge1xuICAgIGZvcm1bJ2NvbW1lbnQnXS5jbGFzc0xpc3QuYWRkKCdlcnJvcicpO1xuICB9XG4gIGhhYmJpdHMgPSBoYWJiaXRzLm1hcCgoaGFiYml0KSA9PiB7XG4gICAgaWYgKGhhYmJpdC5pZCA9PT0gZ2xvYmFsQWN0aXZlSGFiYml0SWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmhhYmJpdCxcbiAgICAgICAgZGF5czogaGFiYml0LmRheXMuY29uY2F0KHsgY29tbWVudCB9KSxcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBoYWJiaXQ7XG4gIH0pO1xuICBmb3JtWydjb21tZW50J10udmFsdWUgPSAnJztcbiAgcmVyZW5kZXIoZ2xvYmFsQWN0aXZlSGFiYml0SWQpO1xuICBzYXZlRGF0YSgpO1xufVxuXG4vL2RlbGV0ZVxuXG5mdW5jdGlvbiBkZWxldGVEYXkoZGF5TnVtYmVyKSB7XG4gIGhhYmJpdHMgPSBoYWJiaXRzLm1hcCgoaGFiYml0KSA9PiB7XG4gICAgaWYgKGhhYmJpdC5pZCA9PT0gZ2xvYmFsQWN0aXZlSGFiYml0SWQpIHtcbiAgICAgIGhhYmJpdC5kYXlzLnNwbGljZShkYXlOdW1iZXIgLSAxLCAxKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmhhYmJpdCxcbiAgICAgICAgZGF5czogaGFiYml0LmRheXMsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gaGFiYml0O1xuICB9KTtcbiAgcmVyZW5kZXIoZ2xvYmFsQWN0aXZlSGFiYml0SWQpO1xuICBzYXZlRGF0YSgpO1xufVxuXG4vL2luaXRcblxuKCgpID0+IHtcbiAgbG9hZERhdGEoKTtcbiAgcmVyZW5kZXIoaGFiYml0c1swXS5pZCk7XG59KSgpO1xuIl19
